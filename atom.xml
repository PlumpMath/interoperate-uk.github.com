<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Interoperate]]></title>
  <link href="http://www.interoperate.co.uk/atom.xml" rel="self"/>
  <link href="http://www.interoperate.co.uk/"/>
  <updated>2012-02-28T10:52:52+00:00</updated>
  <id>http://www.interoperate.co.uk/</id>
  <author>
    <name><![CDATA[Jon Wade]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Sinatra on Rails]]></title>
    <link href="http://www.interoperate.co.uk/blog/2012/02/20/sinatra-on-rails/"/>
    <updated>2012-02-20T21:16:00+00:00</updated>
    <id>http://www.interoperate.co.uk/blog/2012/02/20/sinatra-on-rails</id>
    <content type="html"><![CDATA[<p>I&#8217;m always interested in approaches to modular and minimalist coding.  I&#8217;ve read a few articles about using <a href="http://www.sinatrarb.com/">Sinatra</a> as a DSL for writing &#8216;micro apps&#8217; and can see that it could be useful for writing lightweight applications and APIs and reusing code.  I was also interested from a re-use perspective in how a <a href="http://www.sinatrarb.com/">Sinatra</a> &#8216;micro app&#8217; could be embedded in a &#8216;parent&#8217; Rails application.  Turns out it&#8217;s pretty clean and straightforward.</p>

<!-- More -->


<h2>Creating a Basic Sinatra Application</h2>

<p>First install the Sinatra gem.</p>

<pre><code>gem install sinatra
gem install thin
gem install haml 
</code></pre>

<p>I&#8217;ve included a few optional extras here. By default, <a href="http://www.sinatrarb.com/">Sinatra</a> will use WEBrick for the application server but <a href="http://code.macournoyer.com/thin/">Thin</a> will be used if it is installed.  Also, I much prefer using <a href="http://haml-lang.com/">HAML</a> (Yippeee!) markup over <a href="http://ruby-doc.org/stdlib-1.9.3/libdoc/erb/rdoc/ERB.html">ERB</a> (Ugh, yuk *!&amp;%<sup>+!)</sup> for my view templates.  For my first trivial application I&#8217;m going to show a welcome message and tell the client their IP address (obtained from the &#8216;request&#8217; parameter).</p>

<figure class='code'><figcaption><span>myapp.rb</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="nb">require</span> <span class="s1">&#39;sinatra&#39;</span>
</span><span class='line'><span class="nb">require</span> <span class="s1">&#39;haml&#39;</span>
</span><span class='line'>
</span><span class='line'><span class="n">get</span> <span class="s1">&#39;/&#39;</span> <span class="k">do</span>
</span><span class='line'>  <span class="vi">@client_ip</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">ip</span>
</span><span class='line'>  <span class="n">haml</span> <span class="ss">:index</span><span class="p">,</span> <span class="ss">:format</span> <span class="o">=&gt;</span> <span class="ss">:html5</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="cp">__END__</span>
</span><span class='line'>
</span><span class='line'><span class="cp">@@layout</span>
</span><span class='line'><span class="cp">!!!</span>
</span><span class='line'><span class="cp">%html</span>
</span><span class='line'><span class="cp">  %head</span>
</span><span class='line'><span class="cp">    %title</span>
</span><span class='line'><span class="cp">  %body</span>
</span><span class='line'><span class="cp">    = yield</span>
</span><span class='line'>
</span><span class='line'><span class="cp">@@index</span>
</span><span class='line'><span class="cp">%h1 Hello From Sinatra</span>
</span><span class='line'><span class="cp">%p= &quot;Your IP address is: #{@client_ip}&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<p>That&#8217;s it!  Note that this is the &#8216;inline&#8217; flavour of a Sinatra application.  The view templates are embedded at the end of the ruby source file after the <code>__END__</code> keyword.  The view concept should be familiar to anyone used to Rails.  <a href="http://www.sinatrarb.com/">Sinatra</a> expects a layout called &#8216;layout&#8217; and will use that to embed views using the &#8216;yield&#8217; keyword.  Routing is declared in the <code>get '/' do</code> code block.  Equally you could use &#8216;post&#8217;, &#8216;put&#8217; etc. depending on the preferred HTTP verb and the path.  This application will print a simple message to the screen and notify the user of their client IP address.  To fire up the application, I just type <code>ruby my_app.rb</code> as follows:</p>

<pre><code>$ ruby my_app.rb
== Sinatra/1.3.2 has taken the stage on 4567 for development with backup from Thin
&gt;&gt; Thin web server (v1.3.1 codename Triple Espresso)
&gt;&gt; Maximum connections set to 1024
&gt;&gt; Listening on 0.0.0.0:4567, CTRL+C to stop**
</code></pre>

<p>Pointing my browser at http://localhost:4567 now shows:</p>

<p><img src="http://www.interoperate.co.uk/images/sinatra.png" title="Sinatra" alt="Sinatra"></p>

<h2>Refactoring</h2>

<p>OK, so it&#8217;s not setting the world alight but it&#8217;s quite cool having a web application in a single file with only 21 lines including routing and view templates.  The single file approach is good for minimalist applications but I prefer to have my code organised so I&#8217;m going to do some refactoring.  I&#8217;m going to move the layout and index templates into their own files in a separate folder.  By default, <a href="http://www.sinatrarb.com/">Sinatra</a> expects views to live in <code>./views</code> so I&#8217;m going to stick with that.  You can override the views folder using the <code>set :views, '/path/to/my/views/folder'</code> declaration.</p>

<p>So, my <code>my_app.rb</code> script now looks like this:</p>

<figure class='code'><figcaption><span>my_app.rb</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="nb">require</span> <span class="s1">&#39;sinatra&#39;</span>
</span><span class='line'><span class="nb">require</span> <span class="s1">&#39;haml&#39;</span>
</span><span class='line'>
</span><span class='line'><span class="n">get</span> <span class="s1">&#39;/&#39;</span> <span class="k">do</span>
</span><span class='line'>  <span class="vi">@client_ip</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">ip</span>
</span><span class='line'>  <span class="n">haml</span> <span class="ss">:index</span><span class="p">,</span> <span class="ss">:format</span> <span class="o">=&gt;</span> <span class="ss">:html5</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>and my folder structure looks like this:</p>

<pre><code>.
├── my_app.rb
└── views
    ├── index.haml
    └── layout.haml
</code></pre>

<figure class='code'><figcaption><span>layout.haml</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='haml'><span class='line'><span class="nn">!!!</span>
</span><span class='line'><span class="nt">%html</span>
</span><span class='line'>  <span class="nt">%head</span>
</span><span class='line'>    <span class="nt">%title</span>
</span><span class='line'>  <span class="nt">%body</span>
</span><span class='line'>    <span class="p">=</span> <span class="k">yield</span>
</span></code></pre></td></tr></table></div></figure>


<figure class='code'><figcaption><span>index.haml</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='haml'><span class='line'><span class="nt">%h1</span> Hello From Sinatra
</span><span class='line'><span class="nt">%p</span><span class="p">=</span> <span class="s2">&quot;Your IP address is:</span><span class="si">#{</span><span class="vi">@client_ip</span><span class="si">}</span><span class="s2">&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Mounting a Sinatra App in a Rails Application</h2>

<p>So, now I&#8217;ve got my nice little <a href="http://www.sinatrarb.com/">Sinatra</a> application that will inform users of their client IP address.  I think that this would be a useful application to reuse in a full blown rails application so how do I go about mounting it from Rails?</p>

<h3>Wrapping it up as a Gem</h3>

<p>Firstly, I want to package it up neatly as a Ruby Gem.  This is fairly straightforward.  All I need to do is put my code in a folder called <code>lib</code>, create a <code>my_app.gemspec</code> file and then drop the <code>my_app.gemspec</code> file and the <code>lib</code> directory into a directory called <code>my_app</code>.  My gemspec file looks like this:</p>

<figure class='code'><figcaption><span>my_app.gemspec</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="no">Gem</span><span class="o">::</span><span class="no">Specification</span><span class="o">.</span><span class="n">new</span> <span class="k">do</span> <span class="o">|</span><span class="n">s</span><span class="o">|</span>
</span><span class='line'>  <span class="n">s</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="sx">%q{my_app}</span>
</span><span class='line'>  <span class="n">s</span><span class="o">.</span><span class="n">version</span> <span class="o">=</span> <span class="s2">&quot;1.0.0&quot;</span>
</span><span class='line'>  <span class="n">s</span><span class="o">.</span><span class="n">date</span> <span class="o">=</span> <span class="sx">%q{2012-02-20}</span>
</span><span class='line'>  <span class="n">s</span><span class="o">.</span><span class="n">summary</span> <span class="o">=</span> <span class="sx">%q{blah blah blah}</span>
</span><span class='line'>  <span class="n">s</span><span class="o">.</span><span class="n">files</span> <span class="o">=</span> <span class="o">[</span>
</span><span class='line'>    <span class="s2">&quot;lib/my_app.rb&quot;</span>
</span><span class='line'>  <span class="o">]</span>
</span><span class='line'>  <span class="n">s</span><span class="o">.</span><span class="n">require_paths</span> <span class="o">=</span> <span class="o">[</span><span class="s2">&quot;lib&quot;</span><span class="o">]</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>The folder structure of my &#8216;my_app&#8217; gem looks like this:</p>

<pre><code>./my_app
├── lib
│   ├── my_app.rb
│   └── views
│       ├── index.haml
│       └── layout.haml
└── my_app.gemspec
</code></pre>

<p>We need to make one change to the <code>my_app.rb</code> file to allow Rails to recognise it as a class inheriting from Sinatra::Base.  So I wrap the code in a class declaration as follows:</p>

<figure class='code'><figcaption><span>my_app.rb</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">MyApp</span> <span class="o">&lt;</span> <span class="no">Sinatra</span><span class="o">::</span><span class="no">Base</span>
</span><span class='line'>
</span><span class='line'>  <span class="nb">require</span> <span class="s1">&#39;sinatra&#39;</span>
</span><span class='line'>  <span class="nb">require</span> <span class="s1">&#39;haml&#39;</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">get</span> <span class="s1">&#39;/&#39;</span> <span class="k">do</span>
</span><span class='line'>    <span class="vi">@client_ip</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">ip</span>
</span><span class='line'>    <span class="n">haml</span> <span class="ss">:index</span><span class="p">,</span> <span class="ss">:format</span> <span class="o">=&gt;</span> <span class="ss">:html5</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<h3>Mounting the Sinatra Application from Rails</h3>

<p>I&#8217;m going to mount my gem locally under the lib directory of my Rails application. So I drop the <code>my_app</code> folder into the lib directory of my Rails application  I now need to modify the Gemfile of my Rails application to load the <a href="http://www.sinatrarb.com/">Sinatra</a> gem, as well as my new <code>my_app</code> gem and also any other gems required by the app so I add the following lines:</p>

<figure class='code'><figcaption><span>Gemfile</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">gem</span> <span class="s1">&#39;sinatra&#39;</span>
</span><span class='line'><span class="n">gem</span> <span class="s1">&#39;haml&#39;</span>
</span><span class='line'><span class="n">gem</span> <span class="s1">&#39;my_app&#39;</span><span class="p">,</span> <span class="ss">:path</span> <span class="o">=&gt;</span> <span class="s1">&#39;lib/my_app&#39;</span>
</span></code></pre></td></tr></table></div></figure>


<p>After editing the <code>Gemfile</code> you then need to run <code>bundle update</code> to install the new gems.</p>

<p>Finally, I need to add a route to <code>routes.rb</code> to mount <code>MyApp</code> under the <code>clientip</code> path so that users browsing to <code>http://localhost:3000/clientip</code> will see the information served up by the Sinatra application.  This is accomplished by adding the following line:</p>

<figure class='code'><figcaption><span>routes.rb</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">mount</span> <span class="no">MyApp</span> <span class="o">=&gt;</span> <span class="s2">&quot;/clientip&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Now, when I fire up my Rails application and browse to <code>http:.//localhost:3000/clientip</code>, I get a response from the Sinatra application:</p>

<p><img src="http://www.interoperate.co.uk/images/sinatra2.png" title="Sinatra" alt="Sinatra"></p>

<h2>Conclusion</h2>

<p><a href="http://www.sinatrarb.com/">Sinatra</a> takes a blank canvas approach i.e. you start with nothing and you add what you need.  Conversely, when you create a new Rails application, you get a hell of a lot out of the box and as long as you stick with the Rails conventions, you can save yourself a lot of custom coding.  I like the minimalist aspect of <a href="http://www.sinatrarb.com/">Sinatra</a> and its simplicity but feel that I would soon find myself missing some of the built-in functionality of Rails.  I&#8217;m pretty sure it would be possible to develop some very elegant web applications with very few lines of code.  I don&#8217;t see it as an alternative to Rails but rather as complimentary for discrete functional modules.  It would certainly be very useful for knocking up quick prototype APIs or proof of solution activities.</p>

<p>For some examples of Sinatra in the wild, visit <a href="http://www.sinatrarb.com/wild.html">http://www.sinatrarb.com/wild.html</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Using OpenLayers with Rails]]></title>
    <link href="http://www.interoperate.co.uk/blog/2012/02/07/using-openlayers-with-rails/"/>
    <updated>2012-02-07T09:20:00+00:00</updated>
    <id>http://www.interoperate.co.uk/blog/2012/02/07/using-openlayers-with-rails</id>
    <content type="html"><![CDATA[<p>Over the last few years, I&#8217;ve worked on a few projects that have required the need to display information on a map.  Typically a polyline (or linestring) depicting a journey made by car.  I have previously used Google Maps and interacted directly with the Google Maps API.  However I don&#8217;t like being tied into a single mapping provider and wanted the ability to easily switch between providers if required.  <a href="http://openlayers.org">OpenLayers</a> allows you to do this.  I&#8217;m using Rails and wanted an easy way of storing geodata in a database and have it displayed on a map by <a href="http://openlayers.org">OpenLayers</a>.  Here&#8217;s what I ended up with.</p>

<!-- More -->


<h2>Serving up the geodata in Rails</h2>

<p>I&#8217;m using PostgreSQL for my main Rails database but I&#8217;m also using file based SQLite databases to store datasets of GPS data.  For simplicity, I have a single table called &#8216;gps&#8217; with fields called &#8216;datetime,lat,lon,speed&#8217;.  My data is generally broken down into &#8216;trips&#8217; so I have separate files for each trip.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>sqlite&gt; .schema
</span><span class='line'>CREATE TABLE gps (datetime TEXT,lat REAL,lon REAL,speed REAL);
</span><span class='line'>
</span><span class='line'>sqlite&gt; SELECT * FROM gps LIMIT 5;
</span><span class='line'>2012-02-03 11:15:07.000|53.858473|-1.42572|0.138
</span><span class='line'>2012-02-03 11:15:08.000|53.858473|-1.42572|1.3
</span><span class='line'>2012-02-03 11:15:09.000|53.858477|-1.425728|3.234
</span><span class='line'>2012-02-03 11:15:10.000|53.858487|-1.42575|6.318
</span><span class='line'>2012-02-03 11:15:11.000|53.858505|-1.425785|9.045</span></code></pre></td></tr></table></div></figure>


<p>So, I want this data to be served up by Rails to <a href="http://openlayers.org">OpenLayers</a> in a format that it can understand.  I decided that the easiest way to do this was to use the <a href="http://geojson.org">GeoJSON</a> format as I could just create a &#8216;trip&#8217; as a Ruby Hash object and then use Rails format to serve it up as a JSON object. So in my Trip model I defined a &#8216;geojson&#8217; method that will return a Hash with the same structure as a <a href="http://geojson.org">GeoJSON</a> &#8216;FeatureCollection&#8217; object:</p>

<figure class='code'><figcaption><span>trip.rb</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">Trip</span> <span class="o">&lt;</span> <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Base</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">geojson</span>
</span><span class='line'>    <span class="n">filename</span> <span class="o">=</span> <span class="no">File</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="no">Rails</span><span class="o">.</span><span class="n">root</span><span class="p">,</span><span class="s1">&#39;mydata.db&#39;</span><span class="p">)</span>
</span><span class='line'>    <span class="n">db</span> <span class="o">=</span> <span class="no">SQLite3</span><span class="o">::</span><span class="no">Database</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
</span><span class='line'>    <span class="n">sql</span> <span class="o">=</span> <span class="s2">&quot;SELECT datetime,lon,lat FROM gps ORDER BY datetime ASC;&quot;</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">coordinates</span> <span class="o">=</span> <span class="o">[]</span>
</span><span class='line'>    <span class="n">db</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">sql</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">row</span><span class="o">|</span>
</span><span class='line'>      <span class="n">coordinates</span> <span class="o">&lt;&lt;</span> <span class="o">[</span> <span class="n">row</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span><span class="p">,</span><span class="n">row</span><span class="o">[</span><span class="mi">2</span><span class="o">]</span> <span class="o">]</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1"># return a GeoJSON &#39;FeatureCollection&#39; </span>
</span><span class='line'>    <span class="p">{</span> <span class="ss">:type</span> <span class="o">=&gt;</span> <span class="s2">&quot;FeatureCollection&quot;</span><span class="p">,</span>
</span><span class='line'>      <span class="ss">:features</span> <span class="o">=&gt;</span> <span class="o">[</span>
</span><span class='line'>        <span class="ss">:geometry</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span><span class='line'>          <span class="ss">:type</span> <span class="o">=&gt;</span> <span class="s2">&quot;GeometryCollection&quot;</span><span class="p">,</span>
</span><span class='line'>          <span class="ss">:geometries</span> <span class="o">=&gt;</span> <span class="o">[</span>
</span><span class='line'>            <span class="p">{</span> <span class="ss">:type</span> <span class="o">=&gt;</span> <span class="s2">&quot;LineString&quot;</span><span class="p">,</span> <span class="ss">:coordinates</span> <span class="o">=&gt;</span> <span class="n">coordinates</span> <span class="p">}</span>
</span><span class='line'>          <span class="o">]</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>      <span class="o">]</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>In my controller, I can then just serve up the @trip.geojson Hash as JSON using Rails&#8217;s built in json renderer</p>

<figure class='code'><figcaption><span>trips_controller.rb</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">TripsController</span> <span class="o">&lt;</span> <span class="no">ApplicationController</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">show</span>
</span><span class='line'>    <span class="vi">@trip</span> <span class="o">=</span> <span class="no">Trip</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">params</span><span class="o">[</span><span class="ss">:id</span><span class="o">]</span><span class="p">)</span>
</span><span class='line'>    <span class="n">respond_to</span> <span class="k">do</span> <span class="o">|</span><span class="nb">format</span><span class="o">|</span>
</span><span class='line'>      <span class="c1">#format.html # show.html.erb</span>
</span><span class='line'>      <span class="nb">format</span><span class="o">.</span><span class="n">json</span> <span class="p">{</span> <span class="n">render</span> <span class="n">json</span><span class="p">:</span> <span class="vi">@trip</span><span class="o">.</span><span class="n">geojson</span> <span class="p">}</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>Pointing my browser at http://localhost:3000/trips/1.json will now serve up the JSON file as follows:</p>

<figure class='code'><figcaption><span>http://localhost:3000/trips/1.json</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="p">{</span>
</span><span class='line'>  <span class="nx">type</span><span class="o">:</span> <span class="s2">&quot;FeatureCollection&quot;</span><span class="p">,</span>
</span><span class='line'>  <span class="nx">features</span><span class="o">:</span> <span class="p">[</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>      <span class="nx">geometry</span><span class="o">:</span> <span class="p">{</span>
</span><span class='line'>        <span class="nx">type</span><span class="o">:</span> <span class="s2">&quot;GeometryCollection&quot;</span><span class="p">,</span>
</span><span class='line'>        <span class="nx">geometries</span><span class="o">:</span> <span class="p">[</span>
</span><span class='line'>          <span class="p">{</span>
</span><span class='line'>            <span class="nx">type</span><span class="o">:</span> <span class="s2">&quot;LineString&quot;</span><span class="p">,</span>
</span><span class='line'>            <span class="nx">coordinates</span><span class="o">:</span> <span class="p">[</span>
</span><span class='line'>              <span class="p">[</span> <span class="o">-</span><span class="mf">1.425713</span><span class="p">,</span> <span class="mf">53.858375</span> <span class="p">],</span>
</span><span class='line'>              <span class="p">[</span> <span class="o">-</span><span class="mf">1.425713</span><span class="p">,</span> <span class="mf">53.858375</span> <span class="p">],</span>
</span><span class='line'>              <span class="p">[</span> <span class="o">-</span><span class="mf">1.425713</span><span class="p">,</span> <span class="mf">53.858373</span> <span class="p">],</span>
</span><span class='line'>              <span class="p">[</span> <span class="o">-</span><span class="mf">1.425712</span><span class="p">,</span> <span class="mf">53.858373</span> <span class="p">],</span>
</span><span class='line'>              <span class="p">[</span> <span class="o">-</span><span class="mf">1.425712</span><span class="p">,</span> <span class="mf">53.858372</span> <span class="p">],</span>
</span><span class='line'>              <span class="p">[</span> <span class="p">...</span> <span class="p">]</span>
</span><span class='line'>            <span class="p">]</span>
</span><span class='line'>          <span class="p">}</span>
</span><span class='line'>        <span class="p">]</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>  <span class="p">]</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Generating the Map</h2>

<p>The next thing that I needed to do was to get a basic map up and running with OpenLayers.  There were also some other features that I wanted:</p>

<ol>
<li>To be able to switch between various base layers via a controller on the map:

<ul>
<li>OpenStreetMaps</li>
<li>Google Maps (Roads)</li>
<li>Google Maps (Terrain)</li>
</ul>
</li>
<li>To be able to style the linestring.</li>
<li>To be able to automatically centre the map on the center of the linestring and zoom to a sensible level when the page is loaded.</li>
</ol>


<p>It took me a few hours digging through the OpenLayers API spec and Google to find all the answers but in the end I ended up with this.  The hardest parts were understanding the different projections and working out how the features are returned by the OpenLayers.Format.GeoJSON.read function so that they can be iterated over to set the bounds.</p>

<figure class='code'><figcaption><span>openlayers.js</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kd">var</span> <span class="nx">map</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="kd">function</span> <span class="nx">initializeMap</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>  <span class="c1">// This function is called by the body onload() event in the view</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1">// Define a new map.  We want it to be loaded into the &#39;map_canvas&#39; div in the view</span>
</span><span class='line'>  <span class="nx">map</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">OpenLayers</span><span class="p">.</span><span class="nx">Map</span><span class="p">(</span><span class="s1">&#39;map_canvas&#39;</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1">// Add a LayerSwitcher controller</span>
</span><span class='line'>  <span class="nx">map</span><span class="p">.</span><span class="nx">addControl</span><span class="p">(</span><span class="k">new</span> <span class="nx">OpenLayers</span><span class="p">.</span><span class="nx">Control</span><span class="p">.</span><span class="nx">LayerSwitcher</span><span class="p">());</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1">// OpenStreetMaps</span>
</span><span class='line'>  <span class="kd">var</span> <span class="nx">osm</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">OpenLayers</span><span class="p">.</span><span class="nx">Layer</span><span class="p">.</span><span class="nx">OSM</span><span class="p">();</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1">// Google Maps (ROAD)</span>
</span><span class='line'>  <span class="kd">var</span> <span class="nx">gmap</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">OpenLayers</span><span class="p">.</span><span class="nx">Layer</span><span class="p">.</span><span class="nx">Google</span><span class="p">(</span>
</span><span class='line'>    <span class="s2">&quot;Google Maps&quot;</span><span class="p">,</span>
</span><span class='line'>    <span class="p">{</span> <span class="nx">type</span><span class="o">:</span> <span class="nx">google</span><span class="p">.</span><span class="nx">maps</span><span class="p">.</span><span class="nx">MapTypeId</span><span class="p">.</span><span class="nx">ROAD</span> <span class="p">}</span>
</span><span class='line'>   <span class="p">);</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1">// Google Maps (SATELLITE)</span>
</span><span class='line'>  <span class="kd">var</span> <span class="nx">gsat</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">OpenLayers</span><span class="p">.</span><span class="nx">Layer</span><span class="p">.</span><span class="nx">Google</span><span class="p">(</span>
</span><span class='line'>    <span class="s2">&quot;Google Satellite&quot;</span><span class="p">,</span>
</span><span class='line'>    <span class="p">{</span> <span class="nx">type</span><span class="o">:</span> <span class="nx">google</span><span class="p">.</span><span class="nx">maps</span><span class="p">.</span><span class="nx">MapTypeId</span><span class="p">.</span><span class="nx">SATELLITE</span> <span class="p">}</span>
</span><span class='line'>  <span class="p">);</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1">// Add the layers defined above to the map  </span>
</span><span class='line'>  <span class="nx">map</span><span class="p">.</span><span class="nx">addLayers</span><span class="p">([</span><span class="nx">osm</span><span class="p">,</span> <span class="nx">gmap</span><span class="p">,</span> <span class="nx">gsat</span><span class="p">]);</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1">// Set some styles </span>
</span><span class='line'>  <span class="kd">var</span> <span class="nx">myStyleMap</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">OpenLayers</span><span class="p">.</span><span class="nx">StyleMap</span><span class="p">({</span>
</span><span class='line'>    <span class="s1">&#39;strokeColor&#39;</span><span class="o">:</span> <span class="s1">&#39;magenta&#39;</span><span class="p">,</span>
</span><span class='line'>    <span class="s1">&#39;strokeOpacity&#39;</span><span class="o">:</span> <span class="mf">1.0</span><span class="p">,</span>
</span><span class='line'>    <span class="s1">&#39;strokeWidth&#39;</span><span class="o">:</span> <span class="mi">2</span>
</span><span class='line'>  <span class="p">});</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1">// Create a new vector layer including the above StyleMap</span>
</span><span class='line'>  <span class="kd">var</span> <span class="nx">vectorLayer</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">OpenLayers</span><span class="p">.</span><span class="nx">Layer</span><span class="p">.</span><span class="nx">Vector</span><span class="p">(</span>
</span><span class='line'>    <span class="s2">&quot;Trip&quot;</span><span class="p">,</span>
</span><span class='line'>    <span class="p">{</span> <span class="nx">styleMap</span><span class="o">:</span> <span class="nx">myStyleMap</span> <span class="p">}</span>
</span><span class='line'>  <span class="p">);</span>
</span><span class='line'>  <span class="nx">map</span><span class="p">.</span><span class="nx">addLayer</span><span class="p">(</span><span class="nx">vectorLlayer</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1">// Get the polylines from Rails</span>
</span><span class='line'>  <span class="kd">var</span> <span class="nx">url</span> <span class="o">=</span> <span class="s2">&quot;/trips/1.json&quot;</span>
</span><span class='line'>  <span class="nx">OpenLayers</span><span class="p">.</span><span class="nx">loadURL</span><span class="p">(</span><span class="nx">url</span><span class="p">,</span> <span class="p">{},</span> <span class="kc">null</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">response</span><span class="p">){</span>
</span><span class='line'>    <span class="kd">var</span> <span class="nx">geojson_format</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">OpenLayers</span><span class="p">.</span><span class="nx">Format</span><span class="p">.</span><span class="nx">GeoJSON</span><span class="p">({</span>
</span><span class='line'>      <span class="s1">&#39;internalProjection&#39;</span><span class="o">:</span> <span class="k">new</span> <span class="nx">OpenLayers</span><span class="p">.</span><span class="nx">Projection</span><span class="p">(</span><span class="s2">&quot;EPSG:900913&quot;</span><span class="p">),</span>
</span><span class='line'>      <span class="s1">&#39;externalProjection&#39;</span><span class="o">:</span> <span class="k">new</span> <span class="nx">OpenLayers</span><span class="p">.</span><span class="nx">Projection</span><span class="p">(</span><span class="s2">&quot;EPSG:4326&quot;</span><span class="p">)</span>
</span><span class='line'>    <span class="p">});</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">//Read the GeoJSON</span>
</span><span class='line'>    <span class="kd">var</span> <span class="nx">features</span> <span class="o">=</span> <span class="nx">geojson_format</span><span class="p">.</span><span class="nx">read</span><span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">responseText</span><span class="p">,</span><span class="s2">&quot;FeatureCollection&quot;</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>    <span class="kd">var</span> <span class="nx">bounds</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">if</span><span class="p">(</span><span class="nx">features</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">if</span><span class="p">(</span><span class="nx">features</span><span class="p">.</span><span class="nx">constructor</span> <span class="o">!=</span> <span class="nb">Array</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="nx">features</span> <span class="o">=</span> <span class="p">[</span><span class="nx">features</span><span class="p">];</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>      <span class="c1">// Iterate over the features and extend the bounds to the bounds of the geometries</span>
</span><span class='line'>      <span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="nx">i</span><span class="o">&lt;</span><span class="nx">features</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="o">++</span><span class="nx">i</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">bounds</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>          <span class="nx">bounds</span> <span class="o">=</span> <span class="nx">features</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">geometry</span><span class="p">.</span><span class="nx">getBounds</span><span class="p">();</span>
</span><span class='line'>        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>          <span class="nx">bounds</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">features</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">geometry</span><span class="p">.</span><span class="nx">getBounds</span><span class="p">());</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>      <span class="c1">// Add features to the &#39;vectorLayer&#39;</span>
</span><span class='line'>      <span class="nx">vectorLayer</span><span class="p">.</span><span class="nx">addFeatures</span><span class="p">(</span><span class="nx">features</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>      <span class="c1">// Set the extent of the map to the &#39;bounds&#39;</span>
</span><span class='line'>      <span class="nx">map</span><span class="p">.</span><span class="nx">zoomToExtent</span><span class="p">(</span><span class="nx">bounds</span><span class="p">);</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>  <span class="p">});</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>I&#8217;ve included screenshots below.  Note how the map has been centered on the geometry of the linestring and a sensible zoom level has been set.  You can find a live demo on my <a href="http://sandbox.interoperate.co.uk/openlayers">Sandbox</a> site.</p>

<p><img src="http://www.interoperate.co.uk/images/openstreetmap.jpg" title="OpenStreetMap" alt="OpenStreetMap">
<img src="http://www.interoperate.co.uk/images/google_roads.jpg" title="Google Maps (ROAD)" alt="Google Maps Road">
<img src="http://www.interoperate.co.uk/images/google_satellite.jpg" title="Google Maps (Satellite)" alt="Google Maps Satellite"></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[No Fuss Accounting with Xero]]></title>
    <link href="http://www.interoperate.co.uk/blog/2012/01/17/no-fuss-accounting-with-xero/"/>
    <updated>2012-01-17T23:08:00+00:00</updated>
    <id>http://www.interoperate.co.uk/blog/2012/01/17/no-fuss-accounting-with-xero</id>
    <content type="html"><![CDATA[<p>One of the things that always catches up with me at this time of year is my year end accounts.  As a freelancer, keeping track of expenses and invoices throughout the year is something that I have always found a pain and it inevitably ends up on the back burner.  I&#8217;ve been using spreadsheets for the last few years and my client invoicing process has always been somewhat manual.  I needed a better system and was prepared to spend some cash if it met my requirements.  I came across <a href="http://www.xero.com">Xero</a> after reading a review in <a href="http://www.pcpro.co.uk/reviews/software/367120/xero">PC Pro</a> and decided to give it a go.  I pay £12+VAT per month which is slightly more that I wanted to pay but having used it for a month or so I would say that you definitely get what you pay for.</p>

<p>Killer features for me are:</p>

<!-- More -->


<ol>
<li>Cloud based / SaaS solution - access from anywhere.  Nothing to install.  No backups to worry about.</li>
<li>Automated bank feed - transactions from my HSBC business current account are sent directly to <a href="http://www.xero.com">Xero</a> to be reconciled.  Reconciliation is simply a matter of categorising the transaction and clicking &#8216;OK&#8217;.  It &#8216;learns&#8217; from previous transactions so will suggest an appropriate category for most transactions.</li>
<li>Incoming transactions are reconciled against previously generated invoices.</li>
<li>Role based access - my accountant has privileges to be able to do all the normal chart of accounts and year end submissions.</li>
<li>Invoice generation.  I now produce all my invoices through <a href="http://www.xero.com">Xero</a>.  It&#8217;s really easy to add line items as I go along and then invoice at the end of the month.  Emails are sent directly from <a href="http://www.xero.com">Xero</a> to clients.</li>
<li>VAT returns - I&#8217;ve yet to try this but will be doing this in a couple of weeks.</li>
<li>iPhone App.  A fairly basic app allows you to keep track of accounts and invoices on the go.</li>
</ol>


<p>It couldn&#8217;t be simpler.  All I now really need to worry about is keeping paper copies of invoices and receipts in a shoe box to keep the tax man happy.</p>

<h2>Conclusion</h2>

<p>I&#8217;m really impressed with <a href="http://www.xero.com">Xero</a>.  It&#8217;s a fine example of a hosted service that just works and is a pleasure to use.  I can see many small companies that currently use spreadsheets, <a href="http://www.sage.co.uk/">Sage</a> or <a href="http://www.intuit.co.uk/">Quickbooks</a> migrating to <a href="http://www.xero.com">Xero</a> in the coming months.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Which Ruby Blog Engine?]]></title>
    <link href="http://www.interoperate.co.uk/blog/2012/01/15/which-ruby-blog-engine/"/>
    <updated>2012-01-15T20:23:00+00:00</updated>
    <id>http://www.interoperate.co.uk/blog/2012/01/15/which-ruby-blog-engine</id>
    <content type="html"><![CDATA[<p>So, here I am at the start of 2012 with a bit of time on my hands being &#8216;between contracts&#8217; so I thought I&#8217;d spend a bit of time updating my own website.  After a little thought, I came to the conclusion that all I really need is a blog site for me to record anything that I find remotely interesting and worth sharing.  So, with that in mind, I set about finding a solution for a blogging engine.</p>

<!-- more -->


<p>My key requirements were the usual sort of thing:</p>

<ul>
<li>Written in Ruby</li>
<li>Easily customisable</li>
<li>Quick and easy to update and deploy</li>
<li>Lightweight</li>
<li>Code highlighting support</li>
</ul>


<p>My initial approach was to try and find something that I could plug in to a Rails 3.1 application as an engine and update through a browser.  However, I generally have an aversion to Content Management Systems and didn&#8217;t want anything too heavy.  I much prefer editing raw text files and don&#8217;t like WYSIWYG editors.  After some pondering, I ended up at the excellent <a href="https://www.ruby-toolbox.com/">Ruby Toolbox</a> website which led me to <a href="http://octopress.org">Octopress</a> and so far I haven&#8217;t been disappointed.  I took the decision to deploy it (for free) at Github Pages and so far the experience has been entirely pleasurable.  <a href="http://octopress.org">Octopress</a> is based on the <a href="https://github.com/mojombo/jekyll">Jekyll</a> static site generator that is used by Github pages.  I can&#8217;t believe that I was actually considering writing my own blog engine as a mountable Rails 3.1 engine.  I was up and running within 30 minutes and most of that time was spent deciding which fonts and colour scheme to use.  Updating the website is as simple as committing to Git so if you&#8217;re comfortable with that then you will find it a walk in the park.  As the author acknowledges:</p>

<blockquote><p>Octopress is a blogging framework for hackers. You should be comfortable running shell commands and familiar with the basics of Git. If that sounds daunting, Octopress probably isn’t for you.</p><footer><strong>Brandon Mathis</strong> <cite><a href='http://octopress.org/docs/setup/'>octopress.org/docs/setup/&hellip;</a></cite></footer></blockquote>


<p>Posts are created using a simple rake task <code>rake new_post["My New Interesting Post"]</code>.</p>

<p>New Pages are created just as simply using <code>rake new_page["about"]</code>.</p>

<p>Once you have edited the posts using <a href="http://daringfireball.net/projects/markdown/syntax">Markdown</a> syntax, they are uploaded to Github pages using the following commands which I just wrapped up in a shell script:</p>

<figure class='code'><figcaption><span>deploy.sh</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="c">#!/bin/bash</span>
</span><span class='line'><span class="c"># This will generate the static files and deploy them to your Github pages &#39;master&#39; branch</span>
</span><span class='line'>rake generate
</span><span class='line'>rake deploy
</span><span class='line'><span class="c"># This will deploy the source code to git &#39;source&#39; branch</span>
</span><span class='line'>git add .
</span><span class='line'>git commit -m <span class="s1">&#39;updated&#39;</span>
</span><span class='line'>git push origin <span class="nb">source</span>
</span></code></pre></td></tr></table></div></figure>


<p>A big thanks to <a href="http://brandonmathis.com/">Brandon Mathis</a> for writing <a href="http://octopress.org">Octopress</a>.  It&#8217;s a beautifully clean piece of code and exactly what I was looking for.  Blogging has never been so simple.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Ruby Roman Numeral Method]]></title>
    <link href="http://www.interoperate.co.uk/blog/2012/01/15/ruby-roman-numeral-method/"/>
    <updated>2012-01-15T18:48:00+00:00</updated>
    <id>http://www.interoperate.co.uk/blog/2012/01/15/ruby-roman-numeral-method</id>
    <content type="html"><![CDATA[<p>Just gone live with this blog and I must say that I&#8217;m pretty impressed with <a href="http://octopress.org/">Octopress</a>.  It only took me a few minutes to get it setup and hosted on <a href="http://www.github.com/">GitHub</a> thanks to the excellent documentation.  For my first post I thought I&#8217;d check out the syntax highlighting with a simple Ruby function to extend the core Fixnum class to allow an integer to be converted to Roman numerals.  This syntax highlighting is using the <a href="http://ethanschoonover.com/solarized">Solarized</a> colour palette which has been meticulously designed to allow optimum crispness and legibility on both light and dark backgrounds.  I also use the same colour palette when using <a href="http://www.iterm2.com/#/section/home">Iterm2</a> and <a href="http://www.vim.org/">Vim</a>.</p>

<!-- more -->




<figure class='code'><figcaption><span>Convert to Roman Numerals</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1"># Add a &#39;to_roman&#39; method to the core Fixnum class</span>
</span><span class='line'><span class="no">Fixnum</span><span class="o">.</span><span class="n">class_eval</span> <span class="k">do</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">to_roman</span>
</span><span class='line'>    <span class="n">year</span> <span class="o">=</span> <span class="nb">self</span>
</span><span class='line'>    <span class="n">s</span> <span class="o">=</span> <span class="nb">String</span><span class="o">.</span><span class="n">new</span>
</span><span class='line'>    <span class="n">d</span> <span class="o">=</span> <span class="p">{</span>
</span><span class='line'>      <span class="mi">1000</span> <span class="o">=&gt;</span> <span class="s2">&quot;M&quot;</span><span class="p">,</span>
</span><span class='line'>       <span class="mi">900</span> <span class="o">=&gt;</span> <span class="s2">&quot;CM&quot;</span><span class="p">,</span>
</span><span class='line'>       <span class="mi">500</span> <span class="o">=&gt;</span> <span class="s2">&quot;D&quot;</span><span class="p">,</span>
</span><span class='line'>       <span class="mi">400</span> <span class="o">=&gt;</span> <span class="s2">&quot;CD&quot;</span><span class="p">,</span>
</span><span class='line'>       <span class="mi">100</span> <span class="o">=&gt;</span> <span class="s2">&quot;C&quot;</span><span class="p">,</span>
</span><span class='line'>        <span class="mi">90</span> <span class="o">=&gt;</span> <span class="s2">&quot;XC&quot;</span><span class="p">,</span>
</span><span class='line'>        <span class="mi">50</span> <span class="o">=&gt;</span> <span class="s2">&quot;L&quot;</span><span class="p">,</span>
</span><span class='line'>        <span class="mi">40</span> <span class="o">=&gt;</span> <span class="s2">&quot;XL&quot;</span><span class="p">,</span>
</span><span class='line'>        <span class="mi">10</span> <span class="o">=&gt;</span> <span class="s2">&quot;X&quot;</span><span class="p">,</span>
</span><span class='line'>         <span class="mi">9</span> <span class="o">=&gt;</span> <span class="s2">&quot;IX&quot;</span><span class="p">,</span>
</span><span class='line'>         <span class="mi">5</span> <span class="o">=&gt;</span> <span class="s2">&quot;V&quot;</span><span class="p">,</span>
</span><span class='line'>         <span class="mi">4</span> <span class="o">=&gt;</span> <span class="s2">&quot;IV&quot;</span><span class="p">,</span>
</span><span class='line'>         <span class="mi">1</span> <span class="o">=&gt;</span> <span class="s2">&quot;I&quot;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>    <span class="n">d</span><span class="o">.</span><span class="n">keys</span><span class="o">.</span><span class="n">sort</span><span class="o">.</span><span class="n">reverse_each</span> <span class="k">do</span> <span class="o">|</span><span class="n">k</span><span class="o">|</span>
</span><span class='line'>      <span class="n">w</span><span class="p">,</span><span class="n">r</span> <span class="o">=</span> <span class="n">year</span><span class="o">.</span><span class="n">divmod</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
</span><span class='line'>      <span class="n">s</span> <span class="o">=</span> <span class="n">s</span> <span class="o">+</span> <span class="n">d</span><span class="o">[</span><span class="n">k</span><span class="o">]</span> <span class="o">*</span> <span class="n">w</span>
</span><span class='line'>      <span class="n">year</span> <span class="o">=</span> <span class="n">r</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">s</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># Example Usage</span>
</span><span class='line'><span class="nb">puts</span> <span class="mi">2012</span><span class="o">.</span><span class="n">to_roman</span> <span class="o">=&gt;</span> <span class="s2">&quot;MMXII&quot;</span>
</span></code></pre></td></tr></table></div></figure>

]]></content>
  </entry>
  
</feed>
